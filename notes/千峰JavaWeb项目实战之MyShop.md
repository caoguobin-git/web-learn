# 千峰JavaWeb项目实战之MyShop

[toc]

## 一、网上商城

### 1.1 网上商城介绍

> ​        网上商城类似于现实世界当中的商店，差别是利用电子商务的各种手段，达成从买到卖的过程的虚拟商店，从而减少中间环节，消除运输成本和代理中间的差价，造就对普通消费者和加大市场流通带来拒贷的发展空间。尽可能的还消费者以利益，带动公司发展和企业腾飞，引导国民经济稳定快速发展，推动国内生产总值。

### 1.2 商城类别

| 英文类别 | 介绍                  | 典型代表                                                   |
| -------- | --------------------- | ---------------------------------------------------------- |
| B2B      | Business To Bussiness | 典型代表有阿里巴巴、中国制造网、慧聪等，主要从事批发业务。 |
| B2C      | Business To Customer  | 代表有当当网、京东商城、凡客诚品等。                       |
| C2C      | Customer To Customer  | 代表有淘宝、易趣、拍拍、百度有啊等。                       |
| O2O      | Online To Online      | 代表有象屿商城等。                                         |

### 1.3商城常见模块

> **后台常见模块：**
>
> 1. 商品管理：包括后台商品库存管理、上货、出货、编辑管理和商品分类管理、商品品牌管理等。
> 2. 订单管理：在线订单程序，是消费者能够顺利的通过WEB在线的方式，直接生成购买订单。
> 3. 商品促销：一般的购物系统多有商品促销功能，通过商品促销功能，能够迅速的促进商城的消费积极性。
> 4. 支付方式：即通过网上钱包、电子支付卡。进行网上资金流转换的业务流程；国内主流支付方式包括：支付宝、财付通、网银在线等。还有部分网上商城支持货到付款，入京东商城、第九大道、鹏程万里等。
> 5. 配送方式：购物系统继承的物流配送方式，从而方便消费者对物流方式进行在线玄色。如：EMS、顺丰等。
> 6. 会员模块：在购物系统中，集成会员注册是吸引会员进行二次购买和提升转换率的方式。
>
> **前端界面功能模块**：
>
> 1. 模板风格自定义：即通过系统内置的模板引擎，可以方便的通过后台可视化编辑，设计出符合自身需求的风格界面。
> 2. 商品多图展示：随者电子商务的发展，商品图片成为吸引消费者的第一要素，多图展示即提供前台多张图片的展示，从而提升消费者的购物欲望。
> 3. 自定义广告模块：内置在系统中的广告模块，网站管理员能够顺利的通过操作就可以在前端页面中添加各种广告图片。
> 4. 商品展示：通过前端页面，以标准的或者其他个性化的方式向用户展示商品各类信息，完成构图系统内信息流的传递。
> 5. 购物车：用户可对想要购买的商品进行网上订购，在购物过程中，随时增删商品。

## 二、软件开发流程

> ​		 软件开发流程即软件设计思路和方法的一般过程，包括对软件先进行需求分析，设计软件的功能和实现的算法和方法、软件的总体结构设计和模块设计、编码和调试、程序联调和测试以及编写、提交程序等一系列操作以满足客户的需求并且解决客户的问题，如果有更高需求，还需要对软件进行维护、升级处理，报废处理。
>
> 1. 需求分析
> 2. 概要设计
> 3. 详细设计
> 4. 编码
> 5. 测试
> 6. 交付
> 7. 验收
> 8. 维护

### 2.1 周期和阶段

> 从管理的角度，即从业务和经济的角度来看，软件的生命周期包括四个主要阶段：
>
> * 起始阶段（inception）:有一个好的想法：具体构想出终于产品的设想和它的业务案例，确定项目的范围。
> * 细化阶段（Elaboration）：计划必要的活动那个和所需资源，具体确定功能并设计架构。
> * 构建阶段（Construction）：构建产品，发展最初的设想、构架和计划，直到一个能够交付给用户的产品（完毕后的设想）完毕。
> * 移交阶段（Transition）：将产品移交客户使用，包含：交付、培训、维护。

### 2.2 开发流程

![image-20200706120808431](pic\千峰JavaWeb项目实战之MyShop\image-20200706120808431.png)

#### 2.2.1 需求分析

> 1. 产品经理向客户初步了解需求，然后用相关的工具软件列出要开发的系统的大功能模块，每个大功能模块有那些小功能模块，对于有些需求比较明确的相关界面时，在这一步里面可以初步定义好少量的界面。
> 2. 产品经理深入了解和分析需求，根据自己的经验和需求用WORD或相关的工具再做出一份文档系统的功能需求文档。这次的文档会清楚的列出系统大致的大功能模块，大功能模块有哪些小功能模块，并且还列出相关的界面和界面功能。
> 3. 产品经理向客户确认最终需求。

#### 2.2.2 概要设计

> ​		首先，开发者需要对软件系统进行概要设计，即系统设计。概要设计需要对软件系统的设计进行考虑，包括系统的基本处理流程、系统的组织架构、模块划分、功能分配、接口设计、运行设计、数据结构设计和出错处理设计等，为软件的详细设计提供基础。

#### 2.2.3 详细设计

> ​		在概要设计的基础上，开发者需要进行软件系统的详细设计。在详细设计中，描述实现功能模块所涉及到的主要算法、数据结构、类的层级结构及调用关系，需要说明软件系统各个层次中的每一个程序（每个模块或子程序）的设计考虑，以便进行编码和测试。详细设计应当足够详细，能够根据详细设计报告进行编码。

#### 2.2.4 编码

> ​		 在软件编码阶段，开发者根据《软件系统详细设计报告》中对数据结构、算法分析和模块实现等方面的设计要求，开始具体的编写程序工作，分别实现各模块的功能，从而实现对目标系统的功能、性能、接口、界面等方面的要求。在规范化的研发流程中，编码工作在整个项目流程里最多不会超过1/2，通常在1/3的时间，所谓磨刀不误砍柴功，设计过程完成的好，编码效率就会极大提高，编码时不同模块之间的进度协调和协作是最需要小心的，也许一个小模块的问题就可能影响了整体进度，让很多程序员因此被迫停下工作等待，这种问题在很多研发过程中都出现过。编码时的相互沟通和应急的解决手段都是相当重要的，对于程序员而言，bug永远存在，你必须永远面对这个问题。

#### 2.2.5 测试

> ​		 测试编写好的系统。交给用户使用，用户使用后一个一个的确认功能。软件测试有很多种：按照测试执行方，可以分为内部测试和外部测试；按照测试范围，可以分为模块测试和整体联调；按照测试条件，可以分为正常操作情况和异常操作情况；按照测试的输入范围，可以分为全覆盖测试和抽样测试。总之，测试同样是项目研发中一个相当重要的步骤，对于一个大型软件，3个月到1年的外部测试都是正常的，因为永远都会有不可预料的问题存在。完成测试后，完成验收并完成最后的一些帮助文档，整体项目才算告一段落，当然日后少不了升级，修不等工作，只要不是想通过一锤子买卖骗钱，就要不停的跟踪软件的运营情况并持续修补升级，直到这个软件被彻底淘汰为止。

#### 2.2.6 软件交付

> ​		 在软件测hi证明软件达到要求后，软件开发者应向用户提交开发的目标安装程序、数据库的数据字典、《用户安装手册》、《用户使用指南》、需求报告、设计报告、测试报告等双方合同约定的产物。
>
> ​		 《用户安装手册》应详细介绍安装软件对运行环境的要求、安装软件的定义和内容、在客户端、服务器端及中间件的具体安装步骤、安装后的系统配置。
>
> ​		 《用户使用指南》应包括软件各项功能的使用流程、操作步骤、相应业务介绍、特殊提示和注意事项等方面的内容，在需要时还应举例说明。

#### 2.2.7 验收

> 用户验收。

#### 2.2.8 维护

> ​		 根据用户需求的变化或环境的变化，对应用程序进行全部或部分的更改。



## 三、MyShop项目介绍

### 3.1 开发环境

| 分类         | 名称       | 语种   |
| ------------ | ---------- | ------ |
| 操作系统     | 无要求     | 无要求 |
| 数据库平台   | MySQL 8.0  | -      |
| 应用服务器   | tomcoat 9+ | -      |
| Java开发工具 | IDEA       |        |
| 框架         | 无         |        |
| 项目名称     | 自定义     |        |

### 3.2 主要功能

| 序号 | 模块名称     | 主要功能                                                     |
| :--: | ------------ | ------------------------------------------------------------ |
|  1   | 商品显示模块 | 分页显示所有商品、查看单个商品详细信息、搜索 商品            |
|  2   | 用户模块     | 新用户注册、用户登录、用户登出                               |
|  3   | 购物车模块   | 加入商品到购物车、修改所购商品数量                           |
|  4   | 订单模块     | 提交并显示订单信息、用户确认后生成正式订单、用户查看历史订单 |
|  5   | 支付模块     | 完成在线支付功能                                             |
|  6   | 收货地址     | 管理收货地址                                                 |
|  7   | 后台模块     | 主要实现商品的增删改查                                       |

### 3.3 项目展示

> 1. 导入项目
> 2. 导入数据库
> 3. 运行
> 4. 效果展示

![image-20200706131722525](pic\千峰JavaWeb项目实战之MyShop\image-20200706131722525.png)

## 四、数据库设计

> ​		 数据库设计（Database Desion）是根据用户的需求，在某一具体的数据库管理系统上，设计数据库的结构和建立数据库的过程。

### 4.1 PowerDesigner设计软件介绍

> ​		 Power Designer是能进行数据库设计的强大的软件，是一款开发人员常用的数据库建模工具。使用它可以分别从概念数据模型（Conceptual Data Model）和物理数据模型（Physical Data Model）两个层次对数据库进行设计。

#### 4.1.1 概念数据模型CDM

> ​		 概念数据模型描述的是独立于数据库管理系统（DBMS）的实体定义和实体关系定义。
>
> ​		 在CMD中用来标识实体的是属性（Attribute）。

#### 4.1.2 物理数据模型PDM

> ​		 物理数据模型是在概念数据模型的基础上针对目标数据库管理系统的具体化。
>
> ​		 PDM的对象：表（Table）、表中的列（Table Column）、主外键（Primary、Foreign key）、参照（Reference）、索引（Index）、视图（View）等。
>
> ​		 在PDM中用来表示实体属性的是列（Column）。

#### 4.1.3 CDM和PDM对比

> ​		 CDM概念数据模型：描述要存储的实体、属性、实体关系。
>
> ​		 PDM物理数据模型：对概念数据库模型进行升级，将实体转化成具有数据库特性的模型。
>
> ​		 实体-->表，属性-->列，更进一步完成数据设计。
>
> ​		 总结：类似抽象类和实现的关系。

#### 4.1.4 数据库设计步骤

> 1. 设计CDM模型
> 2. 生成PDM模型
> 3. 生成DBMS脚本

### 4.2 用户模块涉及表

> ​		用户模块主要涉及到用户登录和注册功能以及地址选中功能。
>
> ​		所以：用户模块涉及两张表：用户表和地址表。

#### 4.2.1 用户表

> 存储用户信息：会员和管理员

|   字段   | 类型         | 主键 | 约束             | 备注                          |
| :------: | ------------ | :--: | ---------------- | ----------------------------- |
|    id    | int          |  是  | 自增             | 序号                          |
| username | varchar(20)  |      | Not Null         | 登录账号                      |
| password | varchar(64)  |      | Not Null         | 密码，使用md5                 |
|  email   | varchar(50)  |      | Not Null，Unique | 邮箱，不可重复                |
|  gender  | varchar(2)   |      |                  | 性别                          |
|   flag   | int          |      |                  | 状态标记：0未激活 1激活 2无效 |
|   role   | int          |      |                  | 角色：0管理员 1会员           |
|   code   | varchar(100) |      |                  | 激活码                        |

#### 4.2.2 地址表

|  字段  | 类型         | 主键 | 约束     | 备注                      |
| :----: | ------------ | :--: | -------- | ------------------------- |
|   id   | int          |  是  | 自增     | 地址id                    |
|  name  | varchar(30)  |      | Not Null | 收货人姓名                |
| phone  | varchar(14)  |      | Not Null | 收货人电话                |
| detail | varchar(200) |      | Not Null | 详细地址                  |
| state  | int          |      |          | 是否为默认地址：0不是 1是 |

#### 4.2.3 商品类别表

| 字段 | 类型         | 主键 | 约束     | 备注       |
| :--: | ------------ | :--: | -------- | ---------- |
|  id  | int          |  是  | 自增     | 类别的主键 |
| name | varchar(20)  |      | Not Null | 类别的名称 |
| info | varchar(200) |      | Not Null | 类别的描述 |

#### 4.2.4 商品表

| 字段  | 类型         | 主键 | 约束     | 备注       |
| :---: | ------------ | :--: | -------- | ---------- |
|  id   | int          |  是  | PK       | 商品唯一ID |
| name  | varchar(50)  |      | Not Null | 商品名称   |
| time  | date         |      |          | 上市时间   |
| price | Decimal      |      |          | 商品价格   |
| state | int          |      |          | 热门指数   |
| info  | varchar(200) |      |          | 商品描述   |

#### 4.2.5 购物车表

| 字段  | 类型    | 主键 | 约束 | 备注       |
| :---: | ------- | :--: | ---- | ---------- |
|  id   | int     |  是  | PK   | 主键       |
| count | Decimal |      |      | 购物车小计 |
|  num  | int     |      |      | 购物车数量 |

#### 4.2.6 订单表

| 字段  | 类型     | 主键 | 约束 | 备注           |
| :---: | -------- | :--: | ---- | -------------- |
|  id   | int      |  是  | PK   | 订单的唯一标识 |
| count | decimal  |      |      | 订单总金额     |
| time  | datetime |      |      | 订单时间       |
| state | int      |      |      | 订单状态       |

#### 4.2.7 订单项

| 字段 | 类型 | 主键 | 约束 | 备注             |
| :--: | ---- | :--: | ---- | ---------------- |
|  id  | int  |  是  | PK   | 订单项的唯一标识 |
|      |      |      |      |                  |

## 五、项目搭建和准备工作

> 完成基础项目搭建。

### 5.1 创建项目

### 5.2 导入工具类

### 5.3 导入jar包

### 5.4 导入配置文件

### 5.5 导入页面

### 5.6 创建BaseServlet

* 创建BaseServlet的必要性
* 实现BaseServlet的思路
* 具体BaseServlet的实现

### 5.7 运行项目

## 六、项目编码

> 完成项目的编码工作，以模块为单位，逐一完成。

### 6.1 用户管理模块

> 用户模块涉及功能：注册、登录、自动登录、退出登录。

#### 6.1.1 新用户注册

